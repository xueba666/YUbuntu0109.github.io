<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>How to support full Unicode in MySQL databases | æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~ | My Personal blog website â€”â€” be founded on March 9, 2019</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="MySQL">
    <meta name="description" content="How to support full Unicode in MySQL databases Â· Mathias BynensğŸ˜‚Alternative title: The things we do to store U+1F4A9 PILE OF POO (ğŸ’©) correctly. Are you using MySQLâ€™s utf8 charset in your databases?">
<meta name="keywords" content="MySQL">
<meta property="og:type" content="article">
<meta property="og:title" content="How to support full Unicode in MySQL databases">
<meta property="og:url" content="http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/index.html">
<meta property="og:site_name" content="æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~">
<meta property="og:description" content="How to support full Unicode in MySQL databases Â· Mathias BynensğŸ˜‚Alternative title: The things we do to store U+1F4A9 PILE OF POO (ğŸ’©) correctly. Are you using MySQLâ€™s utf8 charset in your databases?">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-06-23T01:05:01.356Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to support full Unicode in MySQL databases">
<meta name="twitter:description" content="How to support full Unicode in MySQL databases Â· Mathias BynensğŸ˜‚Alternative title: The things we do to store U+1F4A9 PILE OF POO (ğŸ’©) correctly. Are you using MySQLâ€™s utf8 charset in your databases?">
    
        <link rel="alternate" type="application/atom+xml" title="æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/my-portrait.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">é»„å®‡è¾‰</h5>
          <a href="mailto:Gentleman_0109@outlook.com" title="Gentleman_0109@outlook.com" class="mail">Gentleman_0109@outlook.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                homepage
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/YUbuntu0109" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/YUbuntu0109" target="_blank">
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/custom">
                <i class="icon icon-lg icon-link"></i>
                Test
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">How to support full Unicode in MySQL databases</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        

        <!-- background music(Mar 11,2019 AM) -->
        <div>
            <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="52" src="//music.163.com/outchain/player?type=2&id=438801642&auto=1&height=32"></iframe>
        </div>
        <!---------------------->
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">How to support full Unicode in MySQL databases</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-06-23T00:28:41.000Z" itemprop="datePublished" class="page-time">
  2019-06-23
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#How-to-support-full-Unicode-in-MySQL-databases-Â·-Mathias-Bynens"><span class="post-toc-number">1.</span> <span class="post-toc-text">How to support full Unicode in MySQL databases Â· Mathias Bynens</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#UTF-8"><span class="post-toc-number">2.</span> <span class="post-toc-text">UTF-8</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQLâ€™s-utf8"><span class="post-toc-number">3.</span> <span class="post-toc-text">MySQLâ€™s utf8</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQLâ€™s-utf8mb4"><span class="post-toc-number">4.</span> <span class="post-toc-text">MySQLâ€™s utf8mb4</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Step-1-Create-a-backup"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">Step 1: Create a backup</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Step-2-Upgrade-the-MySQL-server"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">Step 2: Upgrade the MySQL server</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Step-3-Modify-databases-tables-and-columns"><span class="post-toc-number">4.3.</span> <span class="post-toc-text">Step 3: Modify databases, tables, and columns</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Step-4-Check-the-maximum-length-of-columns-and-index-keys"><span class="post-toc-number">4.4.</span> <span class="post-toc-text">Step 4: Check the maximum length of columns and index keys</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Step-5-Modify-connection-client-and-server-character-sets"><span class="post-toc-number">4.5.</span> <span class="post-toc-text">Step 5: Modify connection, client, and server character sets</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Step-6-Repair-and-optimize-all-tables"><span class="post-toc-number">4.6.</span> <span class="post-toc-text">Step 6: Repair and optimize all tables</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Summary"><span class="post-toc-number">5.</span> <span class="post-toc-text">Summary</span></a></li></ol>
        </nav>
    </aside>


<article id="post-How-to-support-full-Unicode-in-MySQL-databases" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">How to support full Unicode in MySQL databases</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-06-23 08:28:41" datetime="2019-06-23T00:28:41.000Z" itemprop="datePublished">2019-06-23</time>

            


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="How-to-support-full-Unicode-in-MySQL-databases-Â·-Mathias-Bynens"><a href="#How-to-support-full-Unicode-in-MySQL-databases-Â·-Mathias-Bynens" class="headerlink" title="How to support full Unicode in MySQL databases Â· Mathias Bynens"></a>How to support full Unicode in MySQL databases Â· Mathias Bynens</h2><p>ğŸ˜‚<em>Alternative title: The things we do to store U+1F4A9 PILE OF POO (ğŸ’©) correctly.</em></p>
<p><em>Are you using MySQLâ€™s utf8 charset in your databases? In this write-up Iâ€™ll explain why you should switch to utf8mb4 instead, and how to do it.</em></p>
<h2 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h2><p><em>The UTF-8 encoding can represent every symbol in the Unicode character set, which ranges from U+000000 to U+10FFFF. Thatâ€™s 1,114,112 possible symbols. (Not all of these Unicode code points have been assigned characters yet, but that doesnâ€™t stop UTF-8 from being able to encode them.)</em></p>
<p><em>UTF-8 is a variable-width encoding; it encodes each symbol using one to four 8-bit bytes. Symbols with lower numerical code point values are encoded using fewer bytes. This way, UTF-8 is optimized for the common case where ASCII characters and other BMP symbols (whose code points range from U+000000 to U+00FFFF) are used â€” while still allowing astral symbols (whose code points range from U+010000 to U+10FFFF) to be stored.</em></p>
<h2 id="MySQLâ€™s-utf8"><a href="#MySQLâ€™s-utf8" class="headerlink" title="MySQLâ€™s utf8"></a>MySQLâ€™s utf8</h2><p><em>For a long time, I was using MySQLâ€™s utf8 charset for databases, tables, and columns, assuming it mapped to the UTF-8 encoding described above. By using utf8, Iâ€™d be able to store any symbol I want in my database â€” or so I thought.</em></p>
<p><em>While writing about JavaScriptâ€™s internal character encoding, I noticed that there was no way to insert the U+1D306 TETRAGRAM FOR CENTRE (ğŒ†) symbol into the MySQL database behind this site. The column I was trying to update had the utf8_unicode_ci collation, and the connection charset was set to utf8.</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># just to emphasize that the connection charset is set to `utf8`</span><br><span class="line">mysql&gt; SET NAMES utf8; </span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; UPDATE database_name.table_name SET column_name = &apos;fooğŒ†bar&apos; WHERE id = 9001;</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 1</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT column_name FROM database_name.table_name WHERE id = 9001;</span><br><span class="line">+-------------+</span><br><span class="line">| column_name |</span><br><span class="line">+-------------+</span><br><span class="line">| foo         |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><em>The content got truncated at the first astral Unicode symbol, in this case ğŒ† â€” so, attempting to insert fooğŒ†bar actually inserted foo instead, resulting in data loss (and possibly introducing security issues; see below). MySQL returned a warning message, too:</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW WARNINGS;</span><br><span class="line">+---------+------+------------------------------------------------------------------------------+</span><br><span class="line">| Level   | Code | Message                                                                      |</span><br><span class="line">+---------+------+------------------------------------------------------------------------------+</span><br><span class="line">| Warning | 1366 | Incorrect string value: &apos;\xF0\x9D\x8C\x86&apos; for column &apos;column_name&apos; at row 1 |</span><br><span class="line">+---------+------+------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><em>Turns out MySQLâ€™s utf8 charset only partially implements proper UTF-8 encoding. It can only store UTF-8-encoded symbols that consist of one to three bytes; encoded symbols that take up four bytes arenâ€™t supported.</em></p>
<p><em>Since astral symbols (whose code points range from U+010000 to U+10FFFF) each consist of four bytes in UTF-8, you cannot store them using MySQLâ€™s utf8 implementation.</em></p>
<p><em>This doesnâ€™t just affect the ğŒ† character, but more important symbols like U+01F4A9 PILE OF POO (ğŸ’©) as well. In total, thatâ€™s 1,048,575 possible code points you canâ€™t use. In fact, MySQLâ€™s utf8 only allows you to store 5.88% ((0x00FFFF + 1) / (0x10FFFF + 1)) of all possible Unicode code points. Proper UTF-8 can encode 100% of all Unicode code points.</em></p>
<p><em>As shown above, <code>this behavior can lead to data loss</code>, but it gets worse â€” it can result in security vulnerabilities.MySQLâ€™s utf8 encoding is awkwardly named, as itâ€™s different from proper UTF-8 encoding. It doesnâ€™t offer full Unicode support, which can lead to data loss or security vulnerabilities.</em></p>
<h2 id="MySQLâ€™s-utf8mb4"><a href="#MySQLâ€™s-utf8mb4" class="headerlink" title="MySQLâ€™s utf8mb4"></a>MySQLâ€™s utf8mb4</h2><p><em>Luckily, <code>MySQL 5.5.3 (released in early 2010)</code> introduced a new encoding called utf8mb4 which maps to proper UTF-8 and thus fully supports Unicode, including astral symbols.</em></p>
<p><em>Switching from MySQLâ€™s utf8 to utf8mb4</em></p>
<h3 id="Step-1-Create-a-backup"><a href="#Step-1-Create-a-backup" class="headerlink" title="Step 1: Create a backup"></a>Step 1: Create a backup</h3><p><em>Create a backup of all the databases on the server you want to upgrade. Safety first!</em></p>
<h3 id="Step-2-Upgrade-the-MySQL-server"><a href="#Step-2-Upgrade-the-MySQL-server" class="headerlink" title="Step 2: Upgrade the MySQL server"></a>Step 2: Upgrade the MySQL server</h3><p><em>Upgrade the MySQL server to v5.5.3+, or ask your server administrator to do it for you.</em></p>
<h3 id="Step-3-Modify-databases-tables-and-columns"><a href="#Step-3-Modify-databases-tables-and-columns" class="headerlink" title="Step 3: Modify databases, tables, and columns"></a>Step 3: Modify databases, tables, and columns</h3><p><em>Change the character set and collation properties of the databases, tables, and columns to use utf8mb4 instead of utf8.</em></p>
<ul>
<li>For each database :<br><em><code>ALTER DATABASE database_name CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci</code>;</em></li>
<li>For each table :<br><em><code>ALTER TABLE table_name CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci</code>;</em></li>
<li>For each column :<br><em><code>ALTER TABLE table_name CHANGE column_name column_name VARCHAR(191) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci</code>;</em></li>
<li>(Donâ€™t blindly copy-paste this! The exact statement depends on the column type, maximum length, and other properties. The above line is just an example for a <code>VARCHAR</code> column.)<br>Since utf8mb4 is fully backwards compatible with utf8, no mojibake or other forms of data loss should occur. (But you have a backup, right?)</li>
</ul>
<h3 id="Step-4-Check-the-maximum-length-of-columns-and-index-keys"><a href="#Step-4-Check-the-maximum-length-of-columns-and-index-keys" class="headerlink" title="Step 4: Check the maximum length of columns and index keys"></a>Step 4: Check the maximum length of columns and index keys</h3><p><em>This is probably the most tedious part of the whole upgrading process.</em></p>
<p><em>When converting from utf8 to utf8mb4, the maximum length of a column or index key is unchanged in terms of bytes. Therefore, it is smaller in terms of characters, because the maximum length of a character is now four bytes instead of three.</em></p>
<p><em>For example, a TINYTEXT column can hold up to 255 bytes, which correlates to 85 three-byte or 63 four-byte characters. Letâ€™s say you have a TINYTEXT column that uses utf8 but must be able to contain more than 63 characters. Given this requirement, you canâ€™t convert this column to utf8mb4 unless you also change the data type to a longer type such as TEXT â€” because if youâ€™d try to fill it with four-byte characters, youâ€™d only be able to enter 63 characters, but not more.</em></p>
<p><em>The same goes for index keys. The InnoDB storage engine has a maximum index length of 767 bytes, so for utf8 or utf8mb4 columns, you can index a maximum of 255 or 191 characters, respectively. If you currently have utf8 columns with indexes longer than 191 characters,you will need to index a smaller number of characters when using utf8mb4. (Because of this, I had to change some indexed VARCHAR(255) columns to VARCHAR(191).)</em></p>
<p><em>Section 10.1.11 of the <code>MySQL 5.5</code> Reference Manual has some more information on this.</em></p>
<h3 id="Step-5-Modify-connection-client-and-server-character-sets"><a href="#Step-5-Modify-connection-client-and-server-character-sets" class="headerlink" title="Step 5: Modify connection, client, and server character sets"></a>Step 5: Modify connection, client, and server character sets</h3><p><em>In your application code, set the connection character set to utf8mb4. This can be done by simply replacing any variants of SET NAMES utf8 with SET NAMES utf8mb4. If your old SET NAMES statement specified the collation, make sure to change that as well, e.g. <code>SET NAMES utf8 COLLATE utf8_unicode_ci becomes SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci.</code></em></p>
<p><em>Make sure to set the client and server character set as well. I have the following in my MySQL configuration file (<code>/etc/my.cnf</code>):</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set = utf8mb4</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">character-set-client-handshake = FALSE</span><br><span class="line">character-set-server = utf8mb4</span><br><span class="line">collation-server = utf8mb4_unicode_ci</span><br></pre></td></tr></table></figure></p>
<p><em>You can easily confirm these settings work correctly:</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES WHERE Variable_name LIKE &apos;character\_set\_%&apos; OR Variable_name LIKE &apos;collation%&apos;;</span><br><span class="line">+--------------------------+--------------------+</span><br><span class="line">| Variable_name            | Value              |</span><br><span class="line">+--------------------------+--------------------+</span><br><span class="line">| character_set_client     | utf8mb4            |</span><br><span class="line">| character_set_connection | utf8mb4            |</span><br><span class="line">| character_set_database   | utf8mb4            |</span><br><span class="line">| character_set_filesystem | binary             |</span><br><span class="line">| character_set_results    | utf8mb4            |</span><br><span class="line">| character_set_server     | utf8mb4            |</span><br><span class="line">| character_set_system     | utf8               |</span><br><span class="line">| collation_connection     | utf8mb4_unicode_ci |</span><br><span class="line">| collation_database       | utf8mb4_unicode_ci |</span><br><span class="line">| collation_server         | utf8mb4_unicode_ci |</span><br><span class="line">+--------------------------+--------------------+</span><br><span class="line">10 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure></p>
<p>As you can see, all the relevant options are set to utf8mb4, except for character_set_filesystem which should be binary unless youâ€™re on a file system that supports multi-byte UTF-8-encoded characters in file names, and character_set_system which is always utf8 and canâ€™t be overridden.</p>
<ul>
<li><em><code>Note: The default character set and collation can be configured at some other levels as well.</code></em></li>
</ul>
<h3 id="Step-6-Repair-and-optimize-all-tables"><a href="#Step-6-Repair-and-optimize-all-tables" class="headerlink" title="Step 6: Repair and optimize all tables"></a>Step 6: Repair and optimize all tables</h3><p><em>After upgrading the MySQL server and making the necessary changes explained above, make sure to repair and optimize all databases and tables. I didnâ€™t do this right away after upgrading (I didnâ€™t think it was necessary, as everything seemed to work fine at first glance), and ran into some weird bugs where UPDATE statements didnâ€™t have any effect, even though no errors were thrown.</em></p>
<p><em>You could run the following MySQL queries for each table you want to repair and optimize:</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># For each table</span><br><span class="line">REPAIR TABLE table_name;</span><br><span class="line">OPTIMIZE TABLE table_name;</span><br></pre></td></tr></table></figure></p>
<p><em>Luckily, this can easily be done in one go using the command-line mysqlcheck utility:</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysqlcheck -u root -p --auto-repair --optimize --all-databases</span><br></pre></td></tr></table></figure></p>
<p><em>This will prompt for the root userâ€™s password, after which all tables in all databases will be repaired and optimized.</em></p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p><em><code>Never use utf8 in MySQL â€” always use utf8mb4 instead.</code> Updating your databases and code might take some time, but itâ€™s definitely worth the effort. Why would you arbitrarily limit the set of symbols that can be used in your database? Why would you lose data every time a user enters an astral symbol as part of a comment or message or whatever it is you store in your database? Thereâ€™s no reason not to strive for full Unicode support everywhere. Do the right thing, and use utf8mb4. ğŸ» ãƒ¾(ï¿£â–½ï¿£)Bye~Bye~</em></p>
<ul>
<li><em>ğŸ™‚expressing thanks : <a href="https://mathiasbynens.be/notes/mysql-utf8mb4#utf8-to-utf8mb4" target="_blank" rel="noopener">https://mathiasbynens.be/notes/mysql-utf8mb4#utf8-to-utf8mb4</a></em></li>
</ul>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2019-06-23T01:05:01.356Z" itemprop="dateUpdated">2019-06-23 09:05:01</time>
</span><br>


        
    </div>
    
    <footer>
        <a href="http://yoursite.com">
            <img src="/img/my-portrait.jpg" alt="é»„å®‡è¾‰">
            é»„å®‡è¾‰
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">èµ</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/">MySQL</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/&title=ã€ŠHow to support full Unicode in MySQL databasesã€‹ â€” æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~&pic=http://yoursite.com/img/my-portrait.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/&title=ã€ŠHow to support full Unicode in MySQL databasesã€‹ â€” æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~&source=My personal website ~" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠHow to support full Unicode in MySQL databasesã€‹ â€” æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~&url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/06/23/Hi-Spring-Boot/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Hi Spring Boot ~</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/06/22/SSMé¡¹ç›®-å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">SSMé¡¹ç›®:å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        thanks ~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/Wechat_appreciates.png" alt="æ‰“èµäºŒç»´ç ">
        </div>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <!-- ç»Ÿè®¡ç½‘ç«™ç”¨æˆ·è®¿é—®é‡. æŠ€æœ¯æ”¯æŒï¼šä¸è’œå­(http://busuanzi.ibruce.info/) â€”â€”â€”â€”> Mar 13,2019 -->
        <p>
            <font style="font-size: 12px;color:springgreen">
                    <div align="center">
                        <!-- å®‰è£…è„šæœ¬ -->
                        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                        <!-- å®‰è£…æ ‡ç­¾ -->
                        <span id="busuanzi_container_site_pv">
                            â—ç”¨æˆ·æ€»è®¿é—®é‡ : <span id="busuanzi_value_site_pv"></span> æ¬¡ ~ &nbsp&nbsp
                        </span>
                        <span id="busuanzi_container_site_uv">
                            â—æ€»è®¿å®¢æ•°(ï¼ˆã¥ï¿£3ï¿£ï¼‰ã¥â•­â¤ï½) : <span id="busuanzi_value_site_uv"></span>äºº ~
                        </span>
                    </div>
                </font>
            </p>
            <!---------->
            <p>
                <font style="font-size: 10px">
                    <span>é»„å®‡è¾‰ &copy; 2019</span>
                    <span>
                        
                        Power by <a href="http://hexo.io/" target="_blank">Hexo</a> 
                        <!--Mar 21,2019
                        Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
                        -->
                    </span>
                </font>
            </p>
        </div>
    </footer>
    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/&title=ã€ŠHow to support full Unicode in MySQL databasesã€‹ â€” æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~&pic=http://yoursite.com/img/my-portrait.jpg" data-title="å¾®åš">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="å¾®ä¿¡">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/&title=ã€ŠHow to support full Unicode in MySQL databasesã€‹ â€” æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~&source=My personal website ~" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=ã€ŠHow to support full Unicode in MySQL databasesã€‹ â€” æ¬¢è¿å‚è§‚å°ç°ç°çš„ç½‘ç«™å“Ÿ ãƒ¾(â—Â°âˆ‡Â°â—)ï¾‰ï¾ ~&url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/&via=http://yoursite.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://yoursite.com/2019/06/23/How-to-support-full-Unicode-in-MySQL-databases/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>








<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Where are you going ?';
            clearTimeout(titleTime);
        } else {
            document.title = 'As long as you love me ~';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
